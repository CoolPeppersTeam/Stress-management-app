# План на 8 дней
P. s. обращение к замечательным фронтендерам. Я вставляла вам куски кода. Я писала их по памяти на силе духа, без чата гпт, просто как что ориентировочно должно выглядеть. Этому не стоит верить на слово

P. s. s.  переработки ценятся, отставание карается потом придумаю чем
## 1 день - база 

## Артур

- [X] Подготовить базовые модели (User, StressSession)
- [X] Настроить подключение к постгре (все можно посмотреть в docker-compose.yaml)
- [X] Создать миграцию пользователей
- [X] Создать миграцию сессий

## Катя

- [X] Сделать экран регистрации (в lib/screens/registration_screen.dart)
(то есть ник, имеил, пароль, повторение пароля)
- [X] Сделать ограничение, что пароль должен иметь от 5 символов и хотя бы одну букву, проверка пустых полей, вывод ошибки в противном случае
- [X] Подключить его в main.dart 
- [X] Сразу все сделать максимально по красоте, так как задача сама по себе не супер сложная

## Ксюша

- [x] Сделать экран логина (lib/screens/login_screen.dart)
(почта и пароль)
- [x] Проверка пустых полей, вывод ошибки в противном случае
- [x] Подключить в main.dart
- [x] Сразу все сделать максимально по красоте, так как задача сама по себе не супер сложная

# Катарина

- [X] Сделать экран Главной страницы после входа (lib/screens/home_screen.dart)
пока что просто добро пожаловать и красивые цвета
- [X] Подключить в main.dart (конечно же по пути /)

## Ира (кто-то)

- [X] Хз просто подниму докер несчастный
- [X] Составить план на оставшиеся дни

## 2 день - аутентификация

### Артур

- [X] Регистрация POST /register
- Принимает ник, email, пароль
- Хеширует пароль (bcrypt)
- Создаёт запись в users

- [X] Логин POST /login
- Принимает email, пароль
- При успехе генерирует JWT

- [X] Использовать "github.com/golang-jwt/jwt/v5"

### Ира 

- [X] Настроить .env или config.yaml для конфигурации 
- [X] Сделать пример пул реквестов
- [X] Project board (типо беклог)

### Катя

- [x] Интеграция экрана регистарции с Api (!!!)
- [x] Создать AuthService (lib/services/auth_service.dart)
- Метод регистрации если что:
```
Future<void> register(String email, String password) async {
  final response = await http.post(
    Uri.parse('$baseUrl/register'),
    body: json.encode({'email': email, 'password': password}),
    headers: {'Content-Type': 'application/json'},
  );
  if (response.statusCode != 201) {
    throw Exception('Ошибка регистрации');
  }
}
```
- [x] Подключить вызов к кнопке регистрации
- [x] Связать экран главной страницы со входом

### Ксюша

- [x] Интеграция логина 
- [x] В AuthService (путь указан выше) метод логина:
```
Future<String> login(String email, String password) async {
  final response = await http.post(
    Uri.parse('$baseUrl/login'),
    body: json.encode({'email': email, 'password': password}),
    headers: {'Content-Type': 'application/json'},
  );
  if (response.statusCode == 200) {
    final data = json.decode(response.body);
    return data['token'];
  }
  throw Exception('Ошибка входа');
}
```
- [x] Сохранение jwt в SecureStorage
- [x] Связать экран главной страницы с login

### Катарина

- [ ] Создать SplashScreen для проверки токена
(Это первый экран, который показывается сразу при запуске приложения.
Он нужен для проверки, сохранён ли токен авторизации (jwt). 
решения, куда переходить:

- если токен есть и валиден, показываем главную страницу,

- если токена нет, показываем экран входа.

так пользователь не видит моргание логина, если он авторизован.)

- [ ] При старте Flutter-приложения загрузиться первым экраном.
- [ ] Проверить, сохранён ли токен в SecureStorage.
- [ ] Если токен есть — попытаться сделать запрос (например, GET /sessions) и убедиться, что токен валиден.


## 3 день - круд стресс сессий 

### Артур

- [X] Создание стресс сессий POST /sessions
```
{
  "description": "Переживал на работе",
  "stress_level": 7,
  "date": "2025-07-09"
}
```
- Из JWT вытаскивать user_id

- Записывать в таблицу sessions

- [X] Список всех сессий пользователя GET /sessions
[
  {
    "id": "...",
    "description": "...",
    "stress_level": 7,
    "date": "2025-07-09",
    "created_at": "..."
  }
]

- [X] Удаление сессий /sessions/{id}

### Катя
- [x] Сделать экран добавления сессии (add_session_screen.dart)
- Описание
- Уровень стресса (слайдер от 1 до 10)
- Дата 
- Кнопка "Сохранить"
```
Future<void> addSession(String token, String description, int level, DateTime date) async {
  final response = await http.post(
    Uri.parse('$baseUrl/sessions'),
    headers: {
      'Authorization': 'Bearer $token',
      'Content-Type': 'application/json'
    },
    body: json.encode({
      'description': description,
      'stress_level': level,
      'date': date.toIso8601String()
    }),
  );
  if (response.statusCode != 201) throw Exception('Ошибка создания');
}
```
- [x] После кнопки сохранить перенос на домашнюю страницу со всплывающим уведомлением "успешно сохранено"

- [x] при логине сразу загружать список сессий (Когда пользователь успешно вошёл в систему (то есть логин прошёл, сервер вернул JWT), приложение сразу делает запрос к серверу, чтобы получить его стресс-сессии и показать их на экране.)
НУ ИЛИ 
1. Пользователь ввёл email и пароль → нажал кнопку Войти
2. Сервер вернул токен (JWT)
3. Сохраняется токен в SecureStorage
4. Мгновенно делает запрос GET /sessions
5. Загружает все его записи стресса
6. Показывает их в списке на главной странице
после входа: ```
final token = await authService.login(email, password);
await storage.write(key: 'jwt_token', value: token); ```
 
передача списка:
```
Navigator.pushReplacement(
  context,
  MaterialPageRoute(
    builder: (_) => SessionsListScreen(sessions: sessions),
  ),
);
```

### Ксюша

- [x] Создание экрана списка сессий (sessions_list_screen.dart)
- 
```Future<List<Session>> getSessions(String token) async {
  final response = await http.get(
    Uri.parse('$baseUrl/sessions'),
    headers: {'Authorization': 'Bearer $token'},
  );
  if (response.statusCode == 200) {
    final List data = json.decode(response.body);
    return data.map((e) => Session.fromJson(e)).toList();
  }
  throw Exception('Ошибка загрузки');
}
```
- Модель Session
```
class Session {
  final String id;
  final String description;
  final int stressLevel;
  final DateTime date;

  Session({required this.id, required this.description, required this.stressLevel, required this.date});

  factory Session.fromJson(Map<String, dynamic> json) => Session(
    id: json['id'],
    description: json['description'],
    stressLevel: json['stress_level'],
    date: DateTime.parse(json['date']),
  );
}
```
- [x] Отображать ListView (виджет для отображения списка элементов на экране, чето вроде ленты. я в душе не ебу как оно делается так что кода не будет)

### Катарина
- [ ] Наконец-то избавляемся от затычки экрана
-  Добавить Navigator.push после логина и регистрации
- [ ] Создать Drawer или BottomNavigationBar:
(Главная страница, добавить сессию, история сессий)

### Ира 

- [x] Добавить CORS чтобы все работало
- [X] Сделать ридми приличным
- [X] в доксах сделать страничку с ролями и прочим


## День 4 - статистика и рекомендации

### Артур 
- [X] Эндпоинты статистики и рекомендаций 
- GET /stats
```
{
  "total_sessions": 5,
  "average_stress": 6.3
}
```
- GET /recommendations
```
[
  {"id":1, "title":"Дыхательные упражнения", "text":"..."},
  {"id":2, "title":"Прогулка", "text":"..."}
]
```

### Ира 

- [ ] Наполнить таблицу recommendations 
- [ ] Сделать тестовые данные для всего остального
- [ ] Локализация RU/ENG

### Катя

- [x] Сделать экран рекомендаций recommendations_screen.dart
- Подгрузка рекомендаций из api
- Отображать ListView (заголовок, текст) (выше объясняла)
- [x] Реализация Light/Dart mode

### Ксюша

- [x] Сделать экран статистики stats_screen.dart
- Подгружать /stats 
- [x] Красиво выводить что-то вроде:
Всего сессий: 5
Средний уровень стресса: 6.3
- и в зависимости от кровня стресса выводить всякие поддерживающие надписи

### Катарина

- [x] по желанию и возможностям ебануть график
- [x] В меню добавить пункты "Статистика" и "Рекомендации"
- [ ] Оффлайн кеширование сессий

## 5 день - вебсокет ое

### Артур 

- [x] сделать этот несчастный вебсокет сервер
он нужен нам для обновления стресс сессий. Условно, с того же аккаунта , но в другой вкладке делаем запись сессии и она появляется в списке. Не то что бы практически полезная фича, но тимур харин не простит если не сделаем

(я думаю что ты лучше меня знаешь как это делается, так что без пояснений)

- создать эндпоинт /ws


### Ира

- [ ] Создать функцию с броадкастом
- [ ] в конце для дополнить ридми гифками с важными фичами
- [ ] я вообще не ебу как и зачем для развертывания контейнера сиай сиди, но тимур харин сказал что надо

### Катя 

- [x] Добавить индикатор соединения с вебсокетом
(что-то вроде "соединено", "онлайн", "подключено" или значка вайфай)
- [x] Подключить вебсокет клиент
- создать класс WebSocketClient
- подключаться (хорошая подсказка [вот](https://ru.stackoverflow.com/questions/1154703/%D0%9F%D0%BE%D0%BB%D1%83%D1%87%D0%B5%D0%BD%D0%B8%D0%B5-%D1%81%D1%82%D0%B0%D1%82%D1%83%D1%81%D0%B0-%D0%BF%D0%BE%D0%B4%D0%BA%D0%BB%D1%8E%D1%87%D0%B5%D0%BD%D0%B8%D1%8F-%D0%B2-dart))
- ловить события

### Ксюша 

- [x] Реализовать обновление списка при событии new_session
- В StreamBuilder обновлять список
- Добавлять новые элементы без перезагрузки

## Катарина 




## 6 день - тестирование 

### Артур 

- [ ] Юнит и интегрейшн тесты (я думаю по 1-2 хватит)
- тестировать регистрацию и логин (проверки на успешную регистрацию будет достаточно)
- проверка jwt (запрос без токена/с неправильный - 401) (ну или что угодно другое)

### Ира
- [ ] сделать архитектурную схему

### Катя 

- [ ] Добиваем интерфейс 
- индикатор загрузки при сохранении (заполняющаяся линия)
- сообщение об успехе (или это уже было, не помню)
- [x] очистка формы после сохранения если не сделали ранее
- [x] переход обратно на экран истории

### Ксюша

- [x] Доработать экран истории
- сделать иконку удаления сессий 
- сделать алерт перед удалением (вы точно хотите удалить?) или что-то в этом духе

### Катарина
 
- [x] Украсить экран статистики 
- сделать график уровня стресса, если его не сделали ранее
- показать динамику уровня стресса по датам 
- убедиться в том что UI в порядке


## 7 деннь - финальные проверки 

### Артур 

- [ ] Добавитиь свагер документацию  

### Катя 

- [ ] Проверка экранов на андроид
- проверить весь сценарий: логин, добавление сессии, удаление, рекомендации, статистика
- - [ ] 1 виджет тест

### Ксюша 

- [ ] Проверка на IOS и в браузере 
- тот же сценарий
-  [ ] 1 виджет тест

### Катарина 

- [ ] Подключиться к вебсокету
- [ ] Добавить сессию с другого устройства и убедиться что все записи появляютя сразу
- [ ] Два юнит теста

### Ира

- [ ] До этого дня показать презентацию с которой мы будем выступать

## 8 день - подготовка к сдаче

### Всем

- [ ] убрать временные принты из своего кода 
